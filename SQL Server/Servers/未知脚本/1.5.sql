SELECT 
	'K001'+'&A0102 ='''+RTRIM(CAST(B.A0102 AS VARCHAR))+''' AND K0101='''+RTRIM(CAST(B.K0101 AS VARCHAR))+''' AND K0108 ='+RTRIM(CAST(B.K0108 AS VARCHAR))  AS 编辑, 
	B.HA0102,B.K0101,B.K0108,A.HK1301,B.K1302,B.K1303,B.K1304
FROM A50 A INNER JOIN K001 B ON A.A0102=B.A0102 AND A.K0101=B.K0101
	LEFT JOIN LUDUAN C ON LTRIM(RTRIM(B.K1302))=C.K0101 AND ISNULL(B.K1303,9999)>=C.K0108 AND ISNULL(B.K1303,9999)<C.K0109
WHERE (ISNULL(B.K1303,9999)<>9999 AND C.K0101 IS NULL) OR LEFT(LTRIM(RTRIM(B.K1302)),1) NOT IN ('X','Y','Z','C') 

UNION 

SELECT 
	'K001'+'&A0102 ='''+RTRIM(CAST(B.A0102 AS VARCHAR))+''' AND K0101='''+RTRIM(CAST(B.K0101 AS VARCHAR))+''' AND K0108 ='+RTRIM(CAST(B.K0108 AS VARCHAR))  AS 编辑, 
	B.HA0102,B.K0101,B.K0108,A.HK1301,B.K1302,B.K1303,B.K1304
FROM A50 A INNER JOIN K001 B ON A.A0102=B.A0102 AND A.K0101=B.K0101
	LEFT JOIN LUDUAN C ON LTRIM(RTRIM(B.K1302))=C.K0101 AND ISNULL(B.K1304,9999)>C.K0108 AND ISNULL(B.K1304,9999)<=C.K0109
WHERE (ISNULL(B.K1304,9999)<>9999 AND C.K0101 IS NULL) OR LEFT(LTRIM(RTRIM(B.K1302)),1) NOT IN ('X','Y','Z','C') 