USE NCGL342023
SELECT LDBM,BGYY,XLS.Z
--UPDATE T_LD SET BGYY='21'
FROM T_LD 
LEFT JOIN (
SELECT A,SUBSTRING(A,CHARINDEX(',路段代码=',A)+7,13) Z
FROM OPENROWSET('MICROSOFT.ACE.OLEDB.12.0','EXCEL 5.0;HDR=YES;DATABASE=D:\DESKTOP\表0123.XLS',SHEET1$)
)XLS ON LDBM=XLS.Z
WHERE XLS.Z IS NOT NULL

SELECT YHLC,* FROM T_LD 
--UPDATE T_LD SET YHLC='0.304' 
WHERE LDBM='X304340825010'

SELECT CDSL,BGYY,* FROM T_LD 
--UPDATE T_LD SET CDSL='6',BGYY='21'
WHERE  LDBM='X553341225005' OR LDBM='X308341225026'


SELECT QLBM,BGYY,XLS.Z
--UPDATE T_QL SET BGYY='21'
FROM T_QL
LEFT JOIN (
SELECT A,SUBSTRING(A,CHARINDEX(',桥梁代码=',A)+7,15) Z
FROM OPENROWSET('MICROSOFT.ACE.OLEDB.12.0','EXCEL 5.0;HDR=YES;DATABASE=D:\DESKTOP\表0123.XLS',SHEET2$)
)XLS ON QLBM=XLS.Z
WHERE XLS.Z IS NOT NULL

SELECT JZCBM,XLS.Z,BGYY_XC
--UPDATE T_JZC SET BGYY_XC='21'
FROM T_JZC 
LEFT JOIN (
SELECT A,SUBSTRING(A,CHARINDEX(',建制村代码=',A)+8,12) Z
FROM OPENROWSET('MICROSOFT.ACE.OLEDB.12.0','EXCEL 8.0;HDR=YES;DATABASE=D:\DESKTOP\表0123.XLS',SHEET3$)
)XLS ON JZCBM=XLS.Z
WHERE XLS.Z IS NOT NULL


SELECT SSX,XZBM,XZMC,BGYY_XC
--UPDATE T_XZ SET BGYY_XC='11'
FROM T_XZ 
WHERE  XZBM IN('340827001000','340827002000','340827003000','340826001000','340826002000')
