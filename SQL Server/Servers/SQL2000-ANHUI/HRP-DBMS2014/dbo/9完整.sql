---------------------20240117
--变更原因='10',原乡（镇）代码='340124109000',乡（镇）代码='340124109000',乡（镇）名称='白湖镇'

	USE [NCGL342023]
SELECT xzBm,xls.b,BGYY_XC
--UPDATE T_xz SET BGYY_XC='21'
from T_xz 
left join (
SELECT a,SUBSTRING(a,charindex('乡（镇）代码=',a)+8,12) b
from OPENROWSET('Microsoft.jet.OLEDB.4.0','Excel 8.0;HDR=YES;DATABASE=D:\Desktop\表.xls',sheet6$)
)xls on xzBm=xls.b
WHERE XLS.B IS NOT NULL


SELECT JZCBm,xls.Z,BGYY_XC
--UPDATE T_JZC SET BGYY_XC='21'
from T_JZC 
left join (
SELECT a,SUBSTRING(a,charindex(',建制村代码=',a)+8,12) Z,B,C,D
from OPENROWSET('Microsoft.jet.OLEDB.4.0','Excel 8.0;HDR=YES;DATABASE=D:\Desktop\表.xls',sheet7$)
)xls on JZCBm=xls.Z
WHERE XLS.Z IS NOT NULL




SELECT ZRCZDM,xls.Z,BGYY_XC
--UPDATE T_ZRC SET BGYY_XC='21'
from T_ZRC
left join (
SELECT a,SUBSTRING(a,charindex(',自然村（组）代码=',a)+11,15) Z
from OPENROWSET('Microsoft.jet.OLEDB.4.0','Excel 8.0;HDR=YES;DATABASE=D:\Desktop\表.xls',sheet8$)
)xls on ZRCZDM=xls.Z
WHERE XLS.Z IS NOT NULL


---------------------20240122


USE [NCGL342023]
--本年地理位置发生变更，变更原因填写错误
SELECT ZRCZDM,xls.Z,BGYY_XC
--UPDATE T_ZRC SET BGYY_XC='21'
from T_ZRC
left join (
SELECT a,SUBSTRING(a,18,15) z
from  OPENROWSET('Microsoft.jet.OLEDB.4.0','Excel 5.0;HDR=YES;DATABASE=D:\Desktop\表0122.xls',sheet2$)
where b =21
)xls on ZRCZDM=xls.Z
WHERE XLS.Z IS NOT NULL

--本年地理位置和属性未发生变更，变更原因填写错误
SELECT ZRCZDM,xls.Z,BGYY_XC
--UPDATE T_ZRC SET BGYY_XC='10'
from T_ZRC
left join (
SELECT a,SUBSTRING(a,18,15) z
from  OPENROWSET('Microsoft.jet.OLEDB.4.0','Excel 5.0;HDR=YES;DATABASE=D:\Desktop\表0122.xls',sheet2$)
where b =10
)xls on ZRCZDM=xls.Z
WHERE XLS.Z IS NOT NULL


--本年地理位置发生变更，变更原因填写错误
SELECT JZCBm,xls.Z,BGYY_XC
--UPDATE T_JZC SET BGYY_XC='21'
from T_JZC 
left join (
SELECT a,SUBSTRING(a,9,12) z,B
from  OPENROWSET('Microsoft.jet.OLEDB.4.0','Excel 5.0;HDR=YES;DATABASE=D:\Desktop\表0122.xls',sheet4$)
where b =21
)xls on JZCBm=xls.Z
WHERE XLS.Z IS NOT NULL

--本年地理位置和属性未发生变更，变更原因填写错误
SELECT JZCBm,xls.Z,BGYY_XC
--UPDATE T_JZC SET BGYY_XC='10'
from T_JZC 
left join (
SELECT a,SUBSTRING(a,9,12) z,B
from  OPENROWSET('Microsoft.jet.OLEDB.4.0','Excel 5.0;HDR=YES;DATABASE=D:\Desktop\表0122.xls',sheet4$)
where b =10
)xls on JZCBm=xls.Z
WHERE XLS.Z IS NOT NULL


USE NCGL342023
SELECT ssx,xzBm,xzmc,BGYY_XC
--UPDATE T_xz SET BGYY_XC='10'
from T_xz 
where  xzBm in('340102101000','340102451000','340193450000','340193460000')


USE NCGL342023
SELECT ssx,xzBm,xzmc,BGYY_XC
--UPDATE T_xz SET BGYY_XC='14'
from T_xz 
where  xzBm in('340827001000','340827002000','340827003000','340826001000','340826002000')



SELECT JZCBm,jzcmc,BGYY_XC
--UPDATE T_JZC SET BGYY_XC='10'
from T_JZC 
where  JZCBm in
('340102101001','340102101002','340102101003','340102101004','340102101005','340102101006','340102101007','340102451006','340102451007','340102451008','340193004001','340193004002','340193004003','340193004004','340193004005','340193004006','340193004007','340193004008','340193004009','340193004010','340193005001','340193005002','340193005003','340193005004','340193005005','340193005007','340193005008','340193005010','340193005011','340193450001','340193450002','340193450003','340193450004','340193450005','340193450006','340193450007','340193460001','340193460002','340193460003','340193460005','340193460006')