/*if exists(select * from tempdb..sysobjects where id=object_id('tempdb..#tk06034'))
drop table #tk06034

SELECT
序号,
桥梁名称,
桥梁代码,
桥梁中心桩号,
路线编号,
路线名称,
技术等级,
[桥梁全长(米)],
[跨径总长(米)],
[单孔最大跨径(米)],
[跨径组合(孔*米)],
[桥梁全宽(米)],
[桥面净宽(米)],
按跨径分类代码,
按跨径分类,
按使用年限分类代码,
按使用年限分类,
主桥上部结构类型代码,
主桥上部结构类型,
主桥上部结构材料代码,
主桥上部结构材料,
桥墩类型代码,
桥墩类型,
设计荷载等级代码,
设计荷载等级,
抗震等级代码,
抗震等级,
跨越地物代码,
跨越地物,
跨越地物名称,
防洪标准,
通航等级,
墩台防撞设施类型,
是否互通立交,
建设单位,
设计单位,
施工单位,
监理单位,
修建年度,
建成通车日期,
管养单位单位性质代码,
管养单位名称,
监管单位名称,
收费性质代码,
收费性质,
评定等级代码,
评定等级,
评定日期,
评定单位,
改造年度,
完工日期,
改造部位,
工程性质,
改造施工单位,
是否部补助项目,
当前主要病害部位,
当前主要病害,
交通管制措施代码,
交通管制措施,
所在政区代码,
桥梁所在位置,
是否宽路窄桥,
是否在长大桥梁目录中,
是否跨省桥梁,
是否公铁两用桥梁,
备注,
桥梁身份码
into #tk06034
from OPENROWSET('Microsoft.jet.OLEDB.4.0','Excel 8.0;HDR=YES;DATABASE=D:\Desktop\交公路07表-交控桥梁表 (1).xls',l07$)
--WHERE LEFT(REPLACE(REPLACE(REPLACE(CBMS桥梁编码, 'R', 'L'),'K','L'),'Z','L'),1)IN ('G','H')
*/

SELECT 
序号,
桥梁名称,
桥梁代码,
桥梁中心桩号,
路线编号,
路线名称,
技术等级,
[桥梁全长(米)],
[跨径总长(米)],
[单孔最大跨径(米)],
[跨径组合(孔*米)],
[桥梁全宽(米)],
[桥面净宽(米)],
按跨径分类代码,
按跨径分类,
按使用年限分类代码,
按使用年限分类,
主桥上部结构类型代码,
主桥上部结构类型,
主桥上部结构材料代码,
主桥上部结构材料,
桥墩类型代码,
桥墩类型,
设计荷载等级代码,
设计荷载等级,
抗震等级代码,
抗震等级,
跨越地物代码,
跨越地物,
跨越地物名称,
防洪标准,
通航等级,
墩台防撞设施类型,
是否互通立交,
建设单位,
设计单位,
施工单位,
监理单位,
修建年度,
建成通车日期,
管养单位单位性质代码,
管养单位名称,
监管单位名称,
收费性质代码,
收费性质,
评定等级代码,
评定等级,
评定日期,
评定单位,
改造年度,
完工日期,
改造部位,
工程性质,
改造施工单位,
是否部补助项目,
当前主要病害部位,
当前主要病害,
交通管制措施代码,
交通管制措施,
所在政区代码,
桥梁所在位置,
是否宽路窄桥,
是否在长大桥梁目录中,
是否跨省桥梁,
是否公铁两用桥梁,
备注,
桥梁身份码
from #tk06034
left join 
(
	SELECT * from [HRP-DBMS2014]..k060
	where a0102 like '343%'
)k060 on  case when left(k060.k0101,1) in ('G','S','H','T') THEN rtrim(replace(replace(replace(replace(replace(k060.k0101,'340000',''),'000000',''),'D001',''),'D002',''),'D003',''))+left(rtrim(k060.a0103),6) ELSE rtrim(k060.K0101) END+'L'+rtrim(k060.K6001)=桥梁代码
--order by 序号
