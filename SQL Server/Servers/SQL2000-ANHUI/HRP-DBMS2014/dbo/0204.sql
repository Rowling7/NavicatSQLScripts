
/*if exists(select * from tempdb..sysobjects where id=object_id('tempdb..#tk060343'))
drop table #tk060343

SELECT
序号,
桥梁名称,
CBMS桥梁编码,
REPLACE(REPLACE(REPLACE(CBMS桥梁编码, 'R', 'L'),'K','L'),'Z','L') QLBM,
桥梁代码,
桥梁中心桩号,
路线编号,
路线名称,
技术等级,
桥梁全长,
跨径总长 ,
单孔最大跨径 ,
跨径组合,
桥梁全宽 ,
桥面净宽 ,
按跨径分类代码,
按跨径分类,
按使用年限分类代码,
按使用年限分类,
主桥上部构造结构形式代码,
主桥上部构造结构形式,
主桥上部构造结构形式材料代码,
主桥上部构造结构形式材料,
桥墩类型代码,
桥墩类型,
设计荷载等级代码,
设计荷载等级,
抗震等级代码,
抗震等级,
跨越地物代码,
跨越地物类型,
跨越地物名称,
通航等级,
墩台防撞设施类型,
是否互通立交,
建设单位,
设计单位,
施工单位,
监理单位,
修建年度,
建成通车日期,
管养单位单位性质代码,
管养单位名称,
监管单位名称,
收费性质代码,
收费性质,
技术状况评定等级代码,
技术状况评定等级,
评定日期,
评定单位,
改造年度,
完工日期,
改造部位,
工程性质,
改造施工单位,
是否部补助项目,
当前主要病害部位,
当前主要病害描述,
交通管制措施代码,
交通管制措施,
所在政区代码,
桥梁所在位置,
是否宽路窄桥,
是否在长大桥梁目录中,
是否跨省桥梁,GPS经度,GPS纬度,
是否公铁两用桥梁,
桥梁身份码,
防洪标准,
备注
into #tk060343
from OPENROWSET('Microsoft.jet.OLEDB.4.0','Excel 8.0;HDR=YES;DATABASE=D:\Desktop\公路桥梁明细表（国省道）-安徽省交通控股集团有限公司(2024-02-04)-2.xls',sheet1$)
WHERE LEFT(REPLACE(REPLACE(REPLACE(CBMS桥梁编码, 'R', 'L'),'K','L'),'Z','L'),1)IN ('G','H')
*/

SELECT  序号,
桥梁名称,
CBMS桥梁编码,
REPLACE(REPLACE(REPLACE(CBMS桥梁编码, 'R', 'L'),'K','L'),'Z','L') QLBM,
桥梁代码,
桥梁中心桩号,
路线编号,
路线名称,
技术等级,
桥梁全长,
跨径总长 ,
单孔最大跨径 ,
跨径组合,
桥梁全宽 ,
桥面净宽 ,
按跨径分类代码,
按跨径分类,
按使用年限分类代码,
按使用年限分类,
主桥上部构造结构形式代码,
主桥上部构造结构形式,
主桥上部构造结构形式材料代码,
主桥上部构造结构形式材料,
桥墩类型代码,
桥墩类型,
设计荷载等级代码,
设计荷载等级,
抗震等级代码,
抗震等级,
跨越地物代码,
跨越地物类型,
跨越地物名称,
通航等级,
墩台防撞设施类型,
是否互通立交,
建设单位,
设计单位,
施工单位,
监理单位,
修建年度,
建成通车日期,
管养单位单位性质代码,
管养单位名称,
监管单位名称,
收费性质代码,
收费性质,
技术状况评定等级代码,
技术状况评定等级,
评定日期,
评定单位,
改造年度,
完工日期,
改造部位,
工程性质,
改造施工单位,
是否部补助项目,
当前主要病害部位,
当前主要病害描述,
交通管制措施代码,
交通管制措施,
所在政区代码,
桥梁所在位置,
是否宽路窄桥,
是否在长大桥梁目录中,
是否跨省桥梁,GPS经度,GPS纬度,
是否公铁两用桥梁,
桥梁身份码,
防洪标准,
备注
from #tk060343 
inner join [HRP-DBMS2014]..k060 on qlbm=case when left(k0101,1) in ('G','S','H','T') THEN rtrim(replace(replace(replace(replace(replace(k0101,'340000',''),'000000',''),'D001',''),'D002',''),'D003',''))+left(rtrim(a0103),6) ELSE rtrim(K0101) END+'L'+rtrim(K6001)

