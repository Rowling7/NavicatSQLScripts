if exists(select * from tempdb..sysobjects where id=object_id('tempdb..#tk06034')) drop table #tk060

SELECT 
桥梁身份码,
桥梁名称,
桥梁代码,
中心桩号,
路线号,
路线名称,
路线等级,
路线等级内容,
桥梁全长,
跨径总长,
最大跨径,
跨径组合,
桥面全宽,
桥面净宽,
桥梁类型,
桥梁类型名称,
桥梁分类,
桥梁分类名称,
主桥上部结构,
主桥上部结构内容,
主桥上部材料,
主桥上部材料内容,
桥墩类型,
桥墩类型内容,
设计荷载等级,
设计荷载等级内容,
抗震等级,
抗震等级内容,
跨越地物类型,
跨越地物类型内容,
跨越地物名称,
通航等级,
通航等级内容,
墩台防撞设施类型,
墩台防撞设施类型内容,
是否互通立交,
建设单位,
设计单位,
施工单位,
监理单位,
修建年度,
建成通车日期,
管养单位,
单位名称,
单位公章名称,
监管单位,
收费性质,
收费性质内容,
技术状况评级,
技术状况评级内容,
评定日期,
评定单位,
改造年度,
完工日期,
改造部位,
工程性质,
工程性质内容,
改造施工单位,
是否部补助项目,
主要病害部位,
主要病害,
交通管制措施,
交通管制措施内容,
所在地,
所在地内容,
所在位置,
所在位置内容,
是否宽路窄桥,
是否长大桥,
是否为单柱墩,
是否为公铁跨,
是否为跨航道,
是否为市政管养,
是否为公路监管农村公路,
是否为公路局管养桥,
是否为收费路段,
是否为危桥库,
是否为待贯通路段,
监管分类,
监管分类内容,
路段分类,
是否部挂牌,
是否省挂牌,
报部公路局管养单位,
备注,
桥梁工程师,
桥梁工程师姓名,
经度,
纬度,
正面照片,
总体照片,
入库时间,
是否突发危桥,
是否抗灾能力弱,
是否跨高速,
是否双曲拱,
在线监测,
[汽车10级以下],
[汽车15级且超50年],
[汽车15级且超30年],
[超30年服役且连续三年3类],
是否设计载荷标准低,
是否超龄服役,
市政管养单位,
功能类型,
下穿通道名,
下穿通道桩号,
通行载重,
桥梁坡度,
桥梁平曲线半径,
是否健康检测系统,
桥面标高,
桥下净高,
桥上净高,
引道总宽,
引道路面宽,
引道线形,
引道曲线半径,
中护栏等级,
边护栏等级,
护栏或防撞栏高度,
中央分隔带宽度,
桥面标准净空,
桥面实际净空,
桥下通航等级及标准净空,
桥下实际净空,
设计洪水频率,
设计洪水水位,
历史洪水位,
地震动峰值加速度系数,
桥墩材料,
桥台形式,
桥台材料,
基础形式,
基础材料,
支座形式,
伸缩缝类型,
桥面铺装类型,
桥梁典型照片,
人行道宽度,
首检报告,
负责人姓名,
负责人电话,
负责人单位,
负责人身份证号,
管理单位电话,
养护单位电话,
行政执法单位电话,
监管单位电话,
行政执法单位,
管理单位,
其他管养单位,
待贯通管养单位,
是否跨省桥梁,
防洪标准,
管养单位性质

into #tk060
from OPENROWSET('Microsoft.jet.OLEDB.4.0','Excel 8.0;HDR=YES;DATABASE=D:\Desktop\桥梁身份码清单1.xls',sheet1$)

--2235
SELECT * from #tk060

SELECT * from [HRP-DBMS2014]..k060 t
left join k001 k on t.k0101=k.k0101 
where left(t.k0101,1) in ('g','h') and k.k0304<>'10'
--2212
SELECT 
桥梁身份码,
rtrim(k6040),
桥梁名称,
桥梁代码,
中心桩号,
k060.k6001
from #tk060
inner  join [HRP-DBMS2014]..k060 on  case when left(k060.k0101,1) in ('G','S','H','T') THEN rtrim(replace(replace(replace(replace(replace(k060.k0101,'340000',''),'000000',''),'D001',''),'D002',''),'D003',''))+left(rtrim(k060.a0103),6) ELSE rtrim(k060.K0101) END+'L'+rtrim(k060.K6001)=桥梁代码 
where  桥梁身份码<>rtrim(k6040)--andk060.k6001 is null 
order by 桥梁代码