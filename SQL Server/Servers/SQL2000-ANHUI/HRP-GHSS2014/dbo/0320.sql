SELECT
tK05.路线编号,REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(K05.K0101,'340000',''),'000000',''),'D001','D'),'D002','D'),'D003','D') K0101, tK05.起点桩号,K05.K0105 , tK05.终点桩号,K05.K0106 , RTRIM(检测方向)检测方向,RTRIM(HA5009)HA5009
FROM 	K05 
	
LEFT JOIN D132 ON K05.A5009=D132.OBJNAME
LEFT JOIN A50 ON K05.A0102=A50.A0102 AND K05.K0101=A50.K0101
LEFT JOIN TK05 ON tK05.路线编号=REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(K05.K0101,'340000',''),'000000',''),'D001','D'),'D002','D'),'D003','D') and tK05.起点桩号=K05.K0105 and tK05.终点桩号=K05.K0106 and RTRIM(检测方向)=RTRIM(HA5009)

WHERE	K05.A0102 LIKE '34%'
	AND LEFT(K05.A0101A,4) = '2023'
	AND (SUBSTRING(RTRIM(K05.A0101A),5,1)-1)*3+SUBSTRING(RTRIM(K05.A0101A),6,1)= '12'
--AND K05.k0101 like 'g233%'
--AND 路线编号 IS NULL
--AND K05.K0106 IS NULL
ORDER BY REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(K05.K0101,'340000',''),'000000',''),'D001','D'),'D002','D'),'D003','D') ,K05.K0105 