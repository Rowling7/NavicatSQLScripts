/*
if exists(select * from tempdb..sysobjects where id=object_id('tempdb..##tk001')) drop table ##tk001
INSERT INTO SXZBBG(K01015)
SELECT K01015
from OPENROWSET('Microsoft.ACE.OLEDB.12.0','Excel 8.0;HDR=YES;DATABASE=D:\Desktop\工作簿2.xlsX',sheet2$)
SELECT * FROM ##TK001
*/
--173037
SELECT a0102,k0101,k0115,k0108,k0109,k0114,k1302 ,k1303 ,k1304,k3912,hk3912
from k001 
where k3912 is  null and k1302 is  null
and left(k0101,1) in ('x','y','c','z')

--and rtrim(k0101)+rtrim(k0115)in ( SELECT K0105 FROM ##TK001 )



SELECT RTRIM(K.A0102) A0102,RTRIM(K.K0101) K0101,RTRIM(L.A0102) LA0102,RTRIM(L.K0101) LK0101, K.K0108,K.K0109 , L.K0108 LK0108,L.K0109 LK0109,K.hk3912,k.k1302 ,RTRIM(K.KWYID) KWYID,RTRIM(L.KWYID) LKWYID
--UPDATE K SET K.k1302=K.K0101 ,k1303 =K.K0108,k1304=K.K0109
FROM K001  K 
LEFT JOIN LUDUAN L ON K.A0102=L.A0102 AND K.K0101=L.K0101 AND K.K0108=L.K0108 AND K.K0109=L.K0109
WHERE K.k3912 is  null
and left(K.k0101,1) in ('x','y','c','z')
--AND L.A0102 IS  NULL
--and k.k1302 is  null
--and k.kwyid is not null
and 
ORDER BY L.A0102





if exists(select * from tempdb..sysobjects where id=object_id('tempdb..##tk001')) drop table ##tk001
INSERT INTO SXZBBG(K01015)
SELECT k0101
from OPENROWSET('Microsoft.ACE.OLEDB.12.0','Excel 8.0;HDR=YES;DATABASE=D:\Desktop\工作簿2.xlsX',sheet4$)

USE [NCGL342023]
SELECT LDBM,ZXGJSJ ,jcsj
FROM T_LD
WHERE LDBM LIKE 'X217340322%'


--“变更原因”为“1.新建”或“14.往年建成本年统计”时，“原路线代码”须为空
use [HRP-DBMS2014]
SELECT k1302,k1303,k1304,K3912,hk3912
--update k001 set k1302 = null,k1303 = null,k1304 = null
from k001 
where A3219 in('11','14')
and (k1302 is not null or k1303 is not null or k1304 is not null )



SELECT RTRIM(K.A0102) A0102,RTRIM(K.K0101) K0101,RTRIM(L.A0102) LA0102,RTRIM(L.K0101) LK0101, K.K0108,K.K0109 , L.K0108 LK0108,L.K0109 LK0109,K.hk3912,k.k1302 ,RTRIM(K.KWYID) KWYID,RTRIM(L.KWYID) LKWYID,k.k3912,k.hk3912
--UPDATE K SET K.k1302=K.K0101 ,k1303 =K.K0108,k1304=K.K0109
FROM K001  K 
LEFT JOIN LUDUAN L ON K.A0102=L.A0102 AND K.K0101=L.K0101 AND K.K0108=L.K0108 AND K.K0109=L.K0109
WHERE K.k3912 is  null
and left(K.k0101,1) in ('x','y','c','z')
--AND L.A0102 IS  NULL
--and k.k1302 is  null
--and k.kwyid is not null
ORDER BY L.A0102


SELECT RTRIM(K.A0102) A0102,RTRIM(K.K0101) K0101,RTRIM(L.A0102) LA0102,RTRIM(L.K0101) LK0101, K.K0108,K.K0109 , L.K0108 LK0108,L.K0109 LK0109,K.K0180,K.HA3219,K.hk3912,k.k1302 ,RTRIM(K.KWYID) KWYID,RTRIM(L.KWYID) LKWYID
--UPDATE K SET K.k1302=K.K0101 ,k1303 =K.K0108,k1304=K.K0109
FROM K001  K 
LEFT JOIN LUDUAN L ON K.A0102=L.A0102 AND K.K0101=L.K0101 AND K.K0108=L.K0108 AND K.K0109=L.K0109

WHERE left(K.k0101,1) in ('x','y','c','z')

ORDER BY  K.HA3219,K.hk3912


